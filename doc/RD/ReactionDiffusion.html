
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module ReactionDiffusion</title>
<meta charset="utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom> <br>
<font color="#ffffff" face="helvetica, arial"> <br><big><big><strong>ReactionDiffusion</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href="../index.html">PyCellChemistry documentation index</a><br><a href="file:/Users/lidia/main/research/acbook/web/website/ac-home/pycellchem/pycellchem-2.0/src/RD/ReactionDiffusion.py">/Users/lidia/main/research/acbook/web/website/ac-home/pycellchem/pycellchem-2.0/src/RD/ReactionDiffusion.py</a></font></td></tr></table>
    <p><tt>#---------------------------------------------------------------------------<br>
#<br>
# ReactionDiffusion.py: implementation of reaction-diffusion chemical systems<br>
#<br>
# originally based on the breve Hypercycle.[tz/py] demo by jon klein<br>
# &lt;jk@spiderland.org&gt;, www.spiderland.org<br>
#<br>
# by Lidia Yamamoto, Univ. Basel, Switzerland, January 2010<br>
# 20150910: removed breve dependencies to run within PyCellChemistry<br>
#<br>
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<br>
#<br>
#   Copyright (C) 2015 Lidia A. R. Yamamoto<br>
#   Contact: <a href="http://www.artificial-chemistries.org/">http://www.artificial-chemistries.org/</a><br>
#<br>
#   This file is part of PyCellChemistry.<br>
#<br>
#   PyCellChemistry is free software: you can redistribute it and/or<br>
#   modify it under the terms of the GNU General Public License<br>
#   version 3, as published by the Free Software Foundation.<br>
#<br>
#   PyCellChemistry is distributed in the hope that it will be useful,<br>
#   but WITHOUT ANY WARRANTY; without even the implied warranty of<br>
#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the<br>
#   GNU General Public License for more details.<br>
#<br>
#   You should have received a copy of the GNU General Public License<br>
#   along with PyCellChemistry, see file LICENSE. If not, see<br>
#   <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a><br>
#</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom> <br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>      </tt></td><td> </td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="http://docs.scipy.org/doc/numpy/">numpy</a><br>
</td><td width="25%" valign=top><a href="WritePNG.html">WritePNG</a><br>
</td><td width="25%" valign=top><a href="https://docs.python.org/library/sys">sys</a><br>
</td><td width="25%" valign=top></td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ee77aa">
<td colspan=3 valign=bottom> <br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Classes</strong></big></font></td></tr>
    
<tr><td bgcolor="#ee77aa"><tt>      </tt></td><td> </td>
<td width="100%"><dl>
<dt><font face="helvetica, arial"><a href="../artchem/ReactionVessel.html#ODESystem">artchem.ReactionVessel.ODESystem</a>(<a href="../artchem/ReactionVessel.html#ReactionVessel">artchem.ReactionVessel.ReactionVessel</a>)
</font></dt><dd>
<dl>
<dt><font face="helvetica, arial"><a href="ReactionDiffusion.html#ReactionDiffusionSystem">ReactionDiffusionSystem</a>
</font></dt></dl>
</dd>
</dl>
 <p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ffc8d8">
<td colspan=3 valign=bottom> <br>
<font color="#000000" face="helvetica, arial"><a name="ReactionDiffusionSystem">class <strong>ReactionDiffusionSystem</strong></a>(<a href="../artchem/ReactionVessel.html#ODESystem">artchem.ReactionVessel.ODESystem</a>)</font></td></tr>
    
<tr bgcolor="#ffc8d8"><td rowspan=2><tt>   </tt></td>
<td colspan=2><tt>a PDE integrator for a reaction-diffusion system<br> </tt></td></tr>
<tr><td> </td>
<td width="100%"><dl><dt>Method resolution order:</dt>
<dd><a href="ReactionDiffusion.html#ReactionDiffusionSystem">ReactionDiffusionSystem</a></dd>
<dd><a href="../artchem/ReactionVessel.html#ODESystem">artchem.ReactionVessel.ODESystem</a></dd>
<dd><a href="../artchem/ReactionVessel.html#ReactionVessel">artchem.ReactionVessel.ReactionVessel</a></dd>
</dl>
<hr>
Methods defined here:<br>
<dl><dt><a name="ReactionDiffusionSystem-__init__"><strong>__init__</strong></a>(self, x, y, dx<font color="#909090">=1.0</font>, periodic<font color="#909090">=True</font>, nneighs<font color="#909090">=4</font>)</dt></dl>

<dl><dt><a name="ReactionDiffusionSystem-add_patch"><strong>add_patch</strong></a>(self, mol, conc)</dt><dd><tt>add a patch of chemical at a random location</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-add_patch_at"><strong>add_patch_at</strong></a>(self, mol, conc, x, y)</dt><dd><tt>add some concentration to a patch of chemical at a given<br>
location</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-add_patches"><strong>add_patches</strong></a>(self, npatches, mol, initconc)</dt><dd><tt>add some random patches of chemicals</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-animate"><strong>animate</strong></a>(self, sleeptime<font color="#909090">=1.0</font>, transparent<font color="#909090">=True</font>, blur<font color="#909090">=False</font>)</dt><dd><tt>display the reaction-diffusion grid using vpytyon<br>
transparent: use transparent background instead of black<br>
blur: produce fuzzy borders between cells on the grid</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-close"><strong>close</strong></a>(self)</dt><dd><tt>closes the PDE system such that it can be integrated</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-computeTextureMatrix"><strong>computeTextureMatrix</strong></a>(self, transparent)</dt><dd><tt>produce a texture matrix to be used by <a href="#ReactionDiffusionSystem-animate">animate</a>()</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-conc2img"><strong>conc2img</strong></a>(self, cellsizex, cellsizey, transparent)</dt><dd><tt>convert the concentration matrix to the ARGB format<br>
accepted by png.saveAsPNG()<br>
 <br>
if the transparent flag is set, the resulting png image<br>
will have a transparent background in the spots where<br>
there are no chemicals;<br>
else the image will have a black background in those spots<br>
 <br>
TODO: implement hexagonal grid</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-conc2img_DISABLED"><strong>conc2img_DISABLED</strong></a>(self, cellsizex, cellsizey, transparent)</dt><dd><tt>convert the concentration matrix to the ARGB format<br>
accepted by png.saveAsPNG()<br>
 <br>
tried to use matrix ops for speedup, but it turned out<br>
slower than the element-by-element implementation above</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-deposit"><strong>deposit</strong></a>(self, mol, conc, x, y)</dt><dd><tt>deposit a given amount of a molecule at a precise location</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-diffusion_term"><strong>diffusion_term</strong></a>(self, n)</dt><dd><tt>calculate diffusion term for molecule with index n, for<br>
whole grid at once using matrix operations; leave result<br>
on self.<strong>diff</strong></tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-diffusion_term_NOTUSED"><strong>diffusion_term_NOTUSED</strong></a>(self, n)</dt><dd><tt>calculate diffusion term for molecule with index n, leave<br>
result on self.<strong>diff</strong> (calculate one by one, far too slow,<br>
but I leave the code here to illustrate conceptually how<br>
it works, it's more readable than the matrix form below)</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-disrupt"><strong>disrupt</strong></a>(self, mol, val, x0, y0, x1, y1)</dt><dd><tt>disrupt the concentration of a chemical within a given<br>
rectangle: clamp the concentr to at most val</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-get_color"><strong>get_color</strong></a>(self, mol)</dt><dd><tt>returns the color that has been assigned to molecule mol</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-get_conc"><strong>get_conc</strong></a>(self, mol, x, y)</dt><dd><tt>get concentration of molecule by name, respecting boundaries</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-get_conc_by_index"><strong>get_conc_by_index</strong></a>(self, idx, x, y)</dt><dd><tt>get concentration of molecule by index, respecting boundaries</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-get_diffcoef"><strong>get_diffcoef</strong></a>(self, mol)</dt><dd><tt>returns the diffusion coefficient of molecule mol</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-get_neighbors"><strong>get_neighbors</strong></a>(self)</dt><dd><tt>returns the current neighborhood configuration</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-get_periodic"><strong>get_periodic</strong></a>(self)</dt><dd><tt>True if the current setup is periodic boundary</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-get_pos"><strong>get_pos</strong></a>(self, x, y)</dt><dd><tt>make sure coordinates always fall within boundaries</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-integrate"><strong>integrate</strong></a>(self, dt<font color="#909090">=1.0</font>)</dt><dd><tt>PDE integration of reaction-diffusion system with timestep dt</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-perturb"><strong>perturb</strong></a>(self, mol, prob, ampl, x, y)</dt><dd><tt>perturb concentration at the given point</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-perturbAll"><strong>perturbAll</strong></a>(self, mol, prob, ampl)</dt><dd><tt>perturb the given chemical with a given probability and<br>
amplitude: a random concentration value in the range<br>
[-amp/2 ; ampl/2] will be deposited at each node with<br>
probability prob (if the chemical is not in the node,<br>
nothing happens)</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-perturb_region"><strong>perturb_region</strong></a>(self, mol, prob, ampl, x0, y0, x1, y1)</dt><dd><tt>perturb concentrations in the given region</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-reaction_term"><strong>reaction_term</strong></a>(self, n)</dt><dd><tt>calculate reaction term for molecule with index n, leaving<br>
the result on self.<strong>dcdt</strong></tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-reset"><strong>reset</strong></a>(self, mol, x, y)</dt><dd><tt>reset the concentration of a given molecule to zero</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-resetAll"><strong>resetAll</strong></a>(self, mol<font color="#909090">=''</font>, conc<font color="#909090">=0.0</font>)</dt><dd><tt>reset the concentration of a given molecule to a given<br>
value, overall on the grid; if no molecule is specified,<br>
reset the concentrations of all molecules</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-reset_region"><strong>reset_region</strong></a>(self, mol, val, x0, y0, x1, y1)</dt><dd><tt>set the concentration of substances in this region to the<br>
given value</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-rnd_deposit"><strong>rnd_deposit</strong></a>(self, npoints, mol, conc, ampl<font color="#909090">=0.0</font>)</dt><dd><tt>deposit a random amount of a molecule at random locations</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-set_color"><strong>set_color</strong></a>(self, mol, color)</dt><dd><tt>set color of molecule to color=(red, green, blue)</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-set_conc"><strong>set_conc</strong></a>(self, mol, conc, x, y)</dt><dd><tt>set the concentration of a molecule at position x,y to a<br>
given value, respecting boundary conditions</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-set_diffcoef"><strong>set_diffcoef</strong></a>(self, mol, value)</dt><dd><tt>set the diffusion coefficient of molecule mol</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-set_neighbors"><strong>set_neighbors</strong></a>(self, nn)</dt><dd><tt>set neighborhood configuration: nn = <br>
2: simple (north and right neighbors)<br>
4: Von Neumann<br>
6: hexagonal lattice<br>
8: Moore</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-set_patch"><strong>set_patch</strong></a>(self, mol, conc)</dt><dd><tt>create a patch of chemical at a random location</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-set_patch_at"><strong>set_patch_at</strong></a>(self, mol, conc, x, y)</dt><dd><tt>create a patch of chemical at a given location</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-set_patches"><strong>set_patches</strong></a>(self, npatches, mol, initconc)</dt><dd><tt>create some initial random patches of chemicals</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-set_periodic"><strong>set_periodic</strong></a>(self, flag)</dt><dd><tt>periodic (toroidal) vs. non-periodic boundary conditions</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-trace"><strong>trace</strong></a>(self)</dt><dd><tt>print internal variables, for debug purposes</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-trace_conc"><strong>trace_conc</strong></a>(self)</dt><dd><tt>print the full grid of concentrations for each chemical,<br>
producing a tab-separated matrix for each chemical</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-trace_conc_xy"><strong>trace_conc_xy</strong></a>(self, x, y)</dt><dd><tt>print the concentations of all chemicals at position (x,y)</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-trace_title"><strong>trace_title</strong></a>(self)</dt><dd><tt>output tab-separated title line for plotting</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-writepng"><strong>writepng</strong></a>(self, fname, pngsizex<font color="#909090">=256</font>, pngsizey<font color="#909090">=256</font>, transparent<font color="#909090">=True</font>)</dt><dd><tt>write molecule concentrations to a png image; each grid<br>
position will have a size of cellsize per cellsize pixels</tt></dd></dl>

<hr>
Methods inherited from <a href="../artchem/ReactionVessel.html#ODESystem">artchem.ReactionVessel.ODESystem</a>:<br>
<dl><dt><a name="ReactionDiffusionSystem-get_coefficient"><strong>get_coefficient</strong></a>(self, i)</dt><dd><tt>get kinetic coefficient for reaction (overrides default<br>
ReactionVessel method in order to use vector kv directly;<br>
the result of both methods should be the same though)</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-set_coefficient"><strong>set_coefficient</strong></a>(self, i, k)</dt><dd><tt>update kinetic coefficient for reaction</tt></dd></dl>

<hr>
Methods inherited from <a href="../artchem/ReactionVessel.html#ReactionVessel">artchem.ReactionVessel.ReactionVessel</a>:<br>
<dl><dt><a name="ReactionDiffusionSystem-add"><strong>add</strong></a>(self, reaction)</dt><dd><tt>add a new chemical reaction to the vessel's set of reactions;<br>
'reaction' must be an object of the Reaction class</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-get_names"><strong>get_names</strong></a>(self)</dt><dd><tt>list of all possible molecular species (set S of S,R,A)</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-nreactions"><strong>nreactions</strong></a>(self)</dt><dd><tt>total number of reactions: |R| in S,R,A</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-nspecies"><strong>nspecies</strong></a>(self)</dt><dd><tt>total number of molecular species: |S| in S,R,A</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-parse"><strong>parse</strong></a>(self, reactlist)</dt><dd><tt>invoke the ReactionParser to parse a list of reactions</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-parse_file"><strong>parse_file</strong></a>(self, fname)</dt><dd><tt>invoke the ReactionParser to parse the file named 'fname'</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-parse_input"><strong>parse_input</strong></a>(self, infile)</dt><dd><tt>invoke the ReactionParser to parse an already open input file</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-parse_stdin"><strong>parse_stdin</strong></a>(self)</dt><dd><tt>invoke the ReactionParser to parse the standard input (stdin)</tt></dd></dl>

<dl><dt><a name="ReactionDiffusionSystem-vtime"><strong>vtime</strong></a>(self)</dt><dd><tt>current simulation time</tt></dd></dl>

</td></tr></table></td></tr></table>
<hr>
<p>
<font size="2">Generated automatically by 
<a href="https://docs.python.org/2/library/pydoc.html">pydoc</a>,
July 10, 2015</font>
</body></html>
